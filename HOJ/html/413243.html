b'\r\n\r\n\r\n\r\n\r\n\r\n\r\n<html>\r\n<head>\r\n\t<meta http-equiv="Pragma" content="no-cache">\r\n\t\r\n\t<meta http-equiv="Content-Type" content="text/html; charset=gb2312">\r\n\t<link rel="stylesheet" href="bin/common.css" type="text/css">\r\n\t<title> ACM/ICPC Judge Online of HUNAN UNIVERSITY</title>\r\n</head>\r\n\t\r\n<body topmargin=0 leftmargin=0 rightmargin=0>\r\n  <table border=0 width=100%>\r\n\t<tr height=30 bgcolor="CCCCFF" style="BORDER-top: rgb(242,242,242) 1px solid; BORDER-bottom: rgb(242,242,242) 1px solid; BORDER-left: rgb(242,242,242) 1px solid; BORDER-right: rgb(242,242,242) 1px solid">\r\n\t\t<td width="15%" align=center >      \r\n         <font color=#0000aa face="Tahoma" size=2>Welcome&nbsp;<font color=#0000aa size=2>\xcd\xf6\xc1\xe9\xd0\xf2\xc7\xfa</font></font>\r\n\t\t</td>\r\n\t\t<td align="left">\r\n\t\t<font size=4>&nbsp;&nbsp;HUNAN UNIVERSITY </font><font size=4 face="Tahoma"> ACM/ICPC Judge Online </font>\r\n\t\t</td>\r\n\t</tr>\r\n\t\r\n\t<tr valign=top><td width="15%" bgcolor=#ffffff>\r\n\t\t<table width=100% border=1 bordercolor="#CCCCCC" cellpadding=3 style="border-collapse: collapse">\r\n\t\t\t<tr>\r\n\t\t\t  <td>\r\n\t\t\t\t<a href="http://acm.hnu.cn/online/?" target=_blank class="lead"> <b> Home </b></a> <br>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr>\r\n\t\t\t  <td>\r\n\t\t\t\t<a href="./discuss/?" target=_blank class="lead"> <b>Discuss Board</b></a> <br>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td>\r\n\t\t\t\t<a href="faqs.html" target=_blank class="lead"> <b> FAQs </b></a> \r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td height="20">\r\n\t\t\t\t<form method="post" action="./?action=problem&type=show">\r\n\t\t\t\t<label>Pro</label> \r\n\t\t\t\t<input id="PID" name="id" size="5" value="10"/> \r\n\t\t\t\t<input type="submit" name="submit" value="go " /> \r\n\t\t\t\t</form>\r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td bgcolor=#FFFFFF height=30 align=left><b> Problem Set </b></td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left> <font face="Tahoma">\r\n\t\t\t\t\r\n\t\t\t\t<a href="./?action=problem&type=list" class="lead"><b>Practices</b></a> </font></td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=course&type=list&coursetype=2" class="lead"><b>Online Contests </b></a></font>\r\n\t\t\t[<font color=#0000ff>6</font>]\r\n\t\t\t</td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left> <font face="Tahoma"><a href="./?action=course&type=list&coursetype=1" class="lead"><b>Major Exercises</b></a> </font> </td></tr>\r\n\t\t\t<!--<tr><td bgcolor=#F0F0F0 height=20 align=left> <font face="Tahoma"><a href="./?action=course&type=list&coursetype=3" class="lead"><b>OI Special</b></a> </font> </td></tr>-->\r\n\r\n\t\t\t<tr><td bgcolor=#FFFFFF height=30 align=left><b> Judgement </b></td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=form&type=submitproblem" class="lead"><b>Submit</b></a> </font> </td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=status" class="lead"><b>Online Status</b></a> </font> </td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=user&type=ranklist" class="lead"><b>User RankList</b></a> </font> </td>\r\n\t\t\t</tr>\r\n\r\n\t\t\t<tr><td bgcolor=#FFFFFF   height=30 align=left><b> Users </b></td></tr>\r\n\r\n\t\t\t\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=form&type=modifyuser" class="lead"><b>Edit info</b></a> </font> </td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=user&type=status&id=listarmb" class="lead"> <b>My solved list</b> </a> </font> </td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=form&type=register" class="lead"><b>Register new</b></a> </font> </td></tr>\t\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=form&type=login" class="lead"><b>Login as another</b></a> </font> </td></tr>\r\n\t\t\t<tr><td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="./?action=user&type=logout" class="lead"><b>Logout</b></a> </font> </td></tr>\r\n\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t<tr><td bgcolor=#FFFFFF height=30 align=left><b> Web Links </b></td></tr>\r\n\t\t\t<tr>\r\n\t\t\t  <td bgcolor=#F0F0F0 height=20 align=left><font face="Tahoma"><a href="http://www.hnu.cn" target="_blank" class="lead"><b>HuNan University</b></a> </font> \r\n\t\t\t\t<br><font face="Tahoma"><a href="http://ccc.hnu.cn" target="_blank" class="lead"><b>CS of HNU</b></a> </font> \r\n\t\t\t\t<br>\r\n\t\t\t\t<font face="Tahoma"><a href="http://acm.pku.edu.cn/JudgeOnline/" target="_blank" class="lead"><b>POJ</b></a></font>\t| \r\n\t\t\t\t<font face="Tahoma"><a href="http://acm.zju.edu.cn" target="_blank" class="lead"><b>ZOJ</b></a></font> | <font face="Tahoma"><a href="http://acm.tju.edu.cn" target="_blank" class="lead"><b>TOJ</b></a></font> </td>\r\n\t\t\t</tr>\r\n\t\t\t\r\n\t\t</table>\r\n\t</td>\r\n\t<td bgcolor=#ffffff>\r\n\r\n<table border=0 width=100%>\r\n<tr><td height=30 align=center><font size=4 face="Courier New">Solution 413243\'s Status</font></td></tr>\r\n<tr><td> <b>User: </b>listarmb\r\n , <b>Problem : </b>10020</td></tr>\r\n<tr><td> <b>Language : </b>GNU C++\r\n , <b>Judge Result: </b><font color=#FF0000>Accepted</font></td></tr>\r\n<tr bgcolor=#FFFFFF height=30><td> <b>Source Code </b></td></tr>\r\n<tr><td bgcolor=#DAE6FF><pre>#include&nbsp;&lt;iostream&gt;\r\n#include&nbsp;&lt;queue&gt;\r\nusing&nbsp;namespace&nbsp;std;\r\n\r\nchar&nbsp;pMatrix[21][21][16384];//2^14=16384\r\nchar&nbsp;stone[21][21];\r\nint&nbsp;n,m,L,K;\r\nint&nbsp;maxstep,minstep;\r\nstruct&nbsp;_Point\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;x,y;\r\n};\r\n\r\n_Point&nbsp;pt[8];\r\n\r\nvoid&nbsp;setmap(_Point*&nbsp;_pt)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;i&lt;L;i++)//\xc8\xa5\xcd\xb7\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stone[_pt[i].x][_pt[i].y]=1;\r\n}\r\n\r\nvoid&nbsp;clearmap(_Point*&nbsp;_pt)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;i&lt;L;i++)//\xc8\xa5\xcd\xb7\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stone[_pt[i].x][_pt[i].y]=0;\r\n}\r\n\r\nint&nbsp;bfs(char&nbsp;stone1[][21])\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;queue&lt;int&gt;&nbsp;Q;\r\n&nbsp;&nbsp;&nbsp;&nbsp;Q.push(1);Q.push(1);Q.push(0);\r\n&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!Q.empty())\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;x=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;y=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;_count=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;curx,cury;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;i&lt;4;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curx=x,cury=y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==0)&nbsp;curx--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==1)&nbsp;curx++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==2)&nbsp;cury--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==3)&nbsp;cury++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(curx&lt;1||curx&gt;n||cury&lt;1||cury&gt;m||stone1[curx][cury])&nbsp;continue;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stone1[curx][cury]=1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(curx==pt[0].x&&cury==pt[0].y)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;_count+1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q.push(curx);Q.push(cury);Q.push(_count+1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;\r\n}\r\n\r\nbool&nbsp;getmaxmin()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;maxstep=0,minstep=0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;stone1[21][21];\r\n&nbsp;&nbsp;&nbsp;&nbsp;memcpy(stone1,stone,sizeof(stone));\r\n&nbsp;&nbsp;&nbsp;&nbsp;minstep=bfs(stone1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(minstep==-1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\r\n&nbsp;&nbsp;&nbsp;&nbsp;memcpy(stone1,stone,sizeof(stone));\r\n&nbsp;&nbsp;&nbsp;&nbsp;setmap(pt);\r\n&nbsp;&nbsp;&nbsp;&nbsp;maxstep=bfs(stone);\r\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(maxstep==-1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxstep=0xffff;\r\n&nbsp;&nbsp;&nbsp;&nbsp;memcpy(stone,stone1,sizeof(stone));\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\r\n}\r\n\r\nint&nbsp;getstate()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tmp=0,i;\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=1;i&lt;L;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&lt;&lt;=2;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(pt[i].x&gt;pt[i-1].x)&nbsp;tmp|=0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(pt[i].x&lt;pt[i-1].x)&nbsp;tmp|=1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(pt[i].y&gt;pt[i-1].y)&nbsp;tmp|=2;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;tmp|=3;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tmp;\r\n}\r\n\r\nvoid&nbsp;getcoord(int&nbsp;state,int&nbsp;x,int&nbsp;y)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;pt[0].x=x;pt[0].y=y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;mask=3;\r\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;i&lt;L;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt[i].x=pt[i-1].x;pt[i].y=pt[i-1].y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tmp=(state&gt;&gt;((L-i-1)*2))&mask;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(tmp==0)&nbsp;pt[i].x++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(tmp==1)&nbsp;pt[i].x--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if(tmp==2)&nbsp;pt[i].y++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;pt[i].y--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n}\r\n\r\ninline&nbsp;bool&nbsp;check(int&nbsp;x,int&nbsp;y,int&nbsp;state)\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!(x&lt;1||x&gt;n||y&lt;1||y&gt;m||stone[x][y]||pMatrix[x][y][state]);\r\n}\r\n\r\nint&nbsp;bfs()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;queue&lt;int&gt;&nbsp;Q;\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;state=getstate();\r\n&nbsp;&nbsp;&nbsp;&nbsp;Q.push(pt[0].x);Q.push(pt[0].y);Q.push(state);Q.push(0);\r\n&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(!Q.empty())\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;x=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;y=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;_count=Q.front();Q.pop();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getcoord(state,x,y);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setmap(pt);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;curx,cury,curstate;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=0;i&lt;4;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curx=x,cury=y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==0)&nbsp;curx--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==1)&nbsp;curx++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==2)&nbsp;cury--;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(i==3)&nbsp;cury++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(_count+curx+cury-1&gt;maxstep)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curstate=(L&lt;2)?0:(state&gt;&gt;2)|(i&lt;&lt;((L-2)*2));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!check(curx,cury,curstate))&nbsp;continue;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pMatrix[curx][cury][curstate]=1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(curx==1&&cury==1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;_count+1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Q.push(curx);Q.push(cury);Q.push(curstate);Q.push(_count+1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clearmap(pt);\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;\r\n}\r\n\r\nint&nbsp;main()\r\n{\r\n&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,j=0;\r\n&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(scanf(&quot;%d%d%d&quot;,&n,&m,&L),n&&m&&L)\r\n&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j++;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0;i&lt;L;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scanf(&quot;%d%d&quot;,&pt[i].x,&pt[i].y);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;x,y;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scanf(&quot;%d&quot;,&K);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memset(stone,0,sizeof(stone));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memset(pMatrix,0,sizeof(pMatrix));\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0;i&lt;K;i++)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scanf(&quot;%d%d&quot;,&x,&y);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stone[x][y]=1;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(pt[0].x==1&&pt[0].y==1)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Case&nbsp;%d:&nbsp;%d\\n&quot;,j,0);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(!getmaxmin())\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Case&nbsp;%d:&nbsp;%d\\n&quot;,j,-1);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(maxstep==minstep)\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Case&nbsp;%d:&nbsp;%d\\n&quot;,j,maxstep);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Case&nbsp;%d:&nbsp;%d\\n&quot;,j,bfs());\r\n&nbsp;&nbsp;&nbsp;&nbsp;}\r\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;\r\n}</pre></td><tr>\r\n</table>\r\n\r\n</td> </tr>\r\n<tr><td height=2 bgcolor=#FFFFFF colspan=2></td></tr>\r\n<tr><td colspan=2 align=center height=42><hr color="#F0F0F0" size="1">HUNAN UNIVERSITY ACM/ICPC Judge Online, Version 2005.11.26.final.<br>Web visits:2860 today,55524330 total, since 2006-01-03</td></tr>\r\n</table>\r\n    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>\r\n    <script type="text/javascript">\r\n    _uacct = "UA-566501-1";\r\n    urchinTracker();\r\n    </script>\r\n</body>\r\n\r\n</html>\r\n'